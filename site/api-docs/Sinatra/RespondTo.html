<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf8" />
<title>Module: Sinatra::RespondTo</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (R)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Sinatra.html" title="Sinatra (module)">Sinatra</a></span></span>
     &raquo; 
    <span class="title">RespondTo</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Sinatra::RespondTo
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/sinatra/respond_to.rb<span class="defines">,<br />
  lib/sinatra/respond_to_old.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Defined Under Namespace</h2>
<p class="children">
   
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="RespondTo/Helpers.html" title="Sinatra::RespondTo::Helpers (module)">Helpers</a></span>
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="RespondTo/MissingTemplate.html" title="Sinatra::RespondTo::MissingTemplate (class)">MissingTemplate</a></span>, <span class='object_link'><a href="RespondTo/UnhandledFormat.html" title="Sinatra::RespondTo::UnhandledFormat (class)">UnhandledFormat</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="SUPPORTED_ACCEPT_HEADERS-constant" class="">SUPPORTED_ACCEPT_HEADERS =
          <div class="docstring">
  <div class="discussion">
    <p>
Define all MIME types you want to support here. This conversion table will
be used for auto-negotiation with browser in sinatra when no
&#8216;format&#8217; parameter is specified.
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='lbrace token'>{</span>
  <span class='symbol val'>:xml</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span>
    <span class='string val'>'text/xml'</span><span class='comma token'>,</span>
    <span class='string val'>'application/xml'</span>
  <span class='rbrack token'>]</span><span class='comma token'>,</span>
  <span class='symbol val'>:html</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span>
    <span class='string val'>'text/html'</span><span class='comma token'>,</span>
    <span class='string val'>'application/xhtml+xml'</span>
  <span class='rbrack token'>]</span><span class='comma token'>,</span>
  <span class='symbol val'>:json</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span>
    <span class='string val'>'application/json'</span>
  <span class='rbrack token'>]</span>
<span class='rbrace token'>}</span>
</pre></dd>
      
        <dt id="TEXT_MIME_TYPES-constant" class="">TEXT_MIME_TYPES =
          
        </dt>
        <dd><pre class="code"><span class='lbrack token'>[</span><span class='symbol val'>:txt</span><span class='comma token'>,</span> <span class='symbol val'>:html</span><span class='comma token'>,</span> <span class='symbol val'>:js</span><span class='comma token'>,</span> <span class='symbol val'>:json</span><span class='comma token'>,</span> <span class='symbol val'>:xml</span><span class='comma token'>,</span> <span class='symbol val'>:rss</span><span class='comma token'>,</span> <span class='symbol val'>:atom</span><span class='comma token'>,</span> <span class='symbol val'>:css</span><span class='comma token'>,</span> <span class='symbol val'>:asm</span><span class='comma token'>,</span> <span class='symbol val'>:c</span><span class='comma token'>,</span> <span class='symbol val'>:cc</span><span class='comma token'>,</span> <span class='symbol val'>:conf</span><span class='comma token'>,</span>
<span class='symbol val'>:csv</span><span class='comma token'>,</span> <span class='symbol val'>:cxx</span><span class='comma token'>,</span> <span class='symbol val'>:diff</span><span class='comma token'>,</span> <span class='symbol val'>:dtd</span><span class='comma token'>,</span> <span class='symbol val'>:f</span><span class='comma token'>,</span> <span class='symbol val'>:f77</span><span class='comma token'>,</span> <span class='symbol val'>:f90</span><span class='comma token'>,</span> <span class='symbol val'>:for</span><span class='comma token'>,</span> <span class='symbol val'>:gemspec</span><span class='comma token'>,</span> <span class='symbol val'>:h</span><span class='comma token'>,</span> <span class='symbol val'>:hh</span><span class='comma token'>,</span> <span class='symbol val'>:htm</span><span class='comma token'>,</span>
<span class='symbol val'>:log</span><span class='comma token'>,</span> <span class='symbol val'>:mathml</span><span class='comma token'>,</span> <span class='symbol val'>:mml</span><span class='comma token'>,</span> <span class='symbol val'>:p</span><span class='comma token'>,</span> <span class='symbol val'>:pas</span><span class='comma token'>,</span> <span class='symbol val'>:pl</span><span class='comma token'>,</span> <span class='symbol val'>:pm</span><span class='comma token'>,</span> <span class='symbol val'>:py</span><span class='comma token'>,</span> <span class='symbol val'>:rake</span><span class='comma token'>,</span> <span class='symbol val'>:rb</span><span class='comma token'>,</span> <span class='symbol val'>:rdf</span><span class='comma token'>,</span> <span class='symbol val'>:rtf</span><span class='comma token'>,</span> <span class='symbol val'>:ru</span><span class='comma token'>,</span>
<span class='symbol val'>:s</span><span class='comma token'>,</span> <span class='symbol val'>:sgm</span><span class='comma token'>,</span> <span class='symbol val'>:sgml</span><span class='comma token'>,</span> <span class='symbol val'>:sh</span><span class='comma token'>,</span> <span class='symbol val'>:svg</span><span class='comma token'>,</span> <span class='symbol val'>:svgz</span><span class='comma token'>,</span> <span class='symbol val'>:text</span><span class='comma token'>,</span> <span class='symbol val'>:wsdl</span><span class='comma token'>,</span> <span class='symbol val'>:xhtml</span><span class='comma token'>,</span> <span class='symbol val'>:xsl</span><span class='comma token'>,</span> <span class='symbol val'>:xslt</span><span class='comma token'>,</span> <span class='symbol val'>:yaml</span><span class='comma token'>,</span>
<span class='symbol val'>:yml</span><span class='comma token'>,</span> <span class='symbol val'>:ics</span><span class='comma token'>,</span> <span class='symbol val'>:png</span><span class='rbrack token'>]</span>
</pre></dd>
      
    </dl>
  



  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#registered-class_method" title="registered (class method)">+ (Object) <strong>registered</strong>(app) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#accept_to_array-instance_method" title="#accept_to_array (instance method)">- (Object) <strong>accept_to_array</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
We need to pass array of available response types to best_media_type
method.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lookup_format_from_mime-instance_method" title="#lookup_format_from_mime (instance method)">- (Object) <strong>lookup_format_from_mime</strong>(mime) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Then, when we get best media type for response, we need to know which
format to choose.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="registered-class_method">
  
    + (<tt>Object</tt>) <strong>registered</strong>(app) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sinatra/respond_to.rb', line 59</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='registered identifier id'>registered</span><span class='lparen token'>(</span><span class='app identifier id'>app</span><span class='rparen token'>)</span>
  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='helpers identifier id'>helpers</span> <span class='RespondTo constant id'>RespondTo</span><span class='colon2 op'>::</span><span class='Helpers constant id'>Helpers</span>

  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='set identifier id'>set</span> <span class='symbol val'>:default_charset</span><span class='comma token'>,</span> <span class='string val'>'utf-8'</span>
  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='set identifier id'>set</span> <span class='symbol val'>:default_content</span><span class='comma token'>,</span> <span class='symbol val'>:html</span>
  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='set identifier id'>set</span> <span class='symbol val'>:assume_xhr_is_js</span><span class='comma token'>,</span> <span class='true true kw'>true</span>

<span class='comment val'>#deltacloud: removed the code that tried to 'guess' content based on extension</span>
<span class='comment val'>#as this broke blobstore api (stripping blob names). Use ?format if present, otherwise </span>
<span class='comment val'>#use http accept, otherwise set to default</span>
  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='before identifier id'>before</span> <span class='do do kw'>do</span>
    <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:format</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='@mime_types ivar id'>@mime_types</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='Helpers constant id'>Helpers</span><span class='colon2 op'>::</span><span class='mime_type identifier id'>mime_type</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:format</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
      <span class='format identifier id'>format</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:format</span><span class='rbrack token'>]</span>
    <span class='elsif elsif kw'>elsif</span> <span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'HTTP_ACCEPT'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'HTTP_ACCEPT'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
      <span class='ext identifier id'>ext</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='default_content identifier id'>default_content</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

 <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='configure identifier id'>configure</span> <span class='symbol val'>:development</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='dev identifier id'>dev</span><span class='bitor op'>|</span>
    <span class='dev identifier id'>dev</span><span class='dot token'>.</span><span class='error identifier id'>error</span> <span class='UnhandledFormat constant id'>UnhandledFormat</span> <span class='do do kw'>do</span>
      <span class='content_type identifier id'>content_type</span> <span class='symbol val'>:html</span><span class='comma token'>,</span> <span class='symbol val'>:charset</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'utf-8'</span>

      <span class='lparen token'>(</span><span class='string val'>&quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;style type=\&quot;text/css\&quot;&gt;\nbody { text-align:center;font-family:helvetica,arial;font-size:22px;\ncolor:#888;margin:20px}\n#c {margin:0 auto;width:500px;text-align:left}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h2&gt;Sinatra doesn't know this ditty.&lt;/h2&gt;\n&lt;img src='/__sinatra__/404.png'&gt;\n&lt;div id=\&quot;c\&quot;&gt;\nTry this:\n&lt;pre&gt;\#{request.request_method.downcase} '\#{request.path_info}' do\\n  respond_to do |wants|\\n    wants.\#{format} { \&quot;Hello World\&quot; }\\n  end\\nend&lt;/pre&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/^ {10}/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='dev identifier id'>dev</span><span class='dot token'>.</span><span class='error identifier id'>error</span> <span class='MissingTemplate constant id'>MissingTemplate</span> <span class='do do kw'>do</span>
      <span class='content_type identifier id'>content_type</span> <span class='symbol val'>:html</span><span class='comma token'>,</span> <span class='symbol val'>:charset</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'utf-8'</span>
      <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='status identifier id'>status</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'sinatra.error'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='code identifier id'>code</span>

      <span class='engine identifier id'>engine</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'sinatra.error'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='message identifier id'>message</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='last identifier id'>last</span>
      <span class='engine identifier id'>engine</span> <span class='assign token'>=</span> <span class='string val'>'haml'</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='string val'>'haml'</span><span class='comma token'>,</span> <span class='string val'>'builder'</span><span class='comma token'>,</span> <span class='string val'>'erb'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='engine identifier id'>engine</span>

      <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='path_info identifier id'>path_info</span><span class='rparen token'>)</span>
      <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='string val'>&quot;root&quot;</span> <span class='if if_mod kw'>if</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>

      <span class='format identifier id'>format</span> <span class='assign token'>=</span> <span class='engine identifier id'>engine</span> <span class='eq op'>==</span> <span class='string val'>'builder'</span> <span class='question op'>?</span> <span class='string val'>'xml'</span> <span class='colon op'>:</span> <span class='string val'>'html'</span>

      <span class='layout identifier id'>layout</span> <span class='assign token'>=</span> <span class='case case kw'>case</span> <span class='engine identifier id'>engine</span>
               <span class='when when kw'>when</span> <span class='string val'>'haml'</span> <span class='then then kw'>then</span> <span class='string val'>&quot;!!!\n%html\n  %body= yield&quot;</span>
               <span class='when when kw'>when</span> <span class='string val'>'erb'</span> <span class='then then kw'>then</span> <span class='string val'>&quot;&lt;html&gt;\n  &lt;body&gt;\n    &lt;%= yield %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;&quot;</span>
               <span class='when when kw'>when</span> <span class='string val'>'builder'</span> <span class='then then kw'>then</span> <span class='colon3 op'>::</span><span class='Sinatra constant id'>Sinatra</span><span class='colon2 op'>::</span><span class='VERSION constant id'>VERSION</span> <span class='match op'>=~</span> <span class='regexp val'>/^1.0/</span> <span class='question op'>?</span> <span class='string val'>&quot;xml &lt;&lt; yield&quot;</span> <span class='colon op'>:</span> <span class='string val'>&quot;builder do |xml|\n  xml &lt;&lt; yield\nend&quot;</span>
               <span class='end end kw'>end</span>

      <span class='layout identifier id'>layout</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;&lt;small&gt;app.#{format}.#{engine}&lt;/small&gt;\n&lt;pre&gt;#{escape_html(layout)}&lt;/pre&gt;&quot;</span>

      <span class='lparen token'>(</span><span class='string val'>&quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;style type=\&quot;text/css\&quot;&gt;\nbody { text-align:center;font-family:helvetica,arial;font-size:22px;\ncolor:#888;margin:20px}\n#c {margin:0 auto;width:500px;text-align:left;}\nsmall {float:right;clear:both;}\npre {clear:both;}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h2&gt;Sinatra can't find \#{request.env['sinatra.error'].message}&lt;/h2&gt;\n&lt;img src='/__sinatra__/500.png'&gt;\n&lt;div id=\&quot;c\&quot;&gt;\nTry this:&lt;br /&gt;\n\#{layout}\n&lt;small&gt;\#{path}.\#{format}.\#{engine}&lt;/small&gt;\n&lt;pre&gt;Hello World!&lt;/pre&gt;\n&lt;small&gt;application.rb&lt;/small&gt;\n&lt;pre&gt;\#{request.request_method.downcase} '\#{request.path_info}' do\\n  respond_to do |wants|\\n    wants.\#{engine == 'builder' ? 'xml' : 'html'} { \#{engine} :\#{path}\#{\&quot;,\\n\#{' '*32}layout =&gt; :app\&quot; if layout} }\\n  end\\nend&lt;/pre&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/^ {10}/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='class_eval identifier id'>class_eval</span> <span class='do do kw'>do</span>
    <span class='private identifier id'>private</span>
      <span class='def def kw'>def</span> <span class='accept_list identifier id'>accept_list</span>
        <span class='@mime_types ivar id'>@mime_types</span> <span class='orop op'>||</span> <span class='Rack constant id'>Rack</span><span class='colon2 op'>::</span><span class='AcceptMediaTypes constant id'>AcceptMediaTypes</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>'HTTP_ACCEPT'</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>

      <span class='comment val'># Changes in 1.0 Sinatra reuse render for layout so we store</span>
      <span class='comment val'># the original value to tell us if this is an automatic attempt</span>
      <span class='comment val'># to do a layout call.  If it is, it might fail with Errno::ENOENT</span>
      <span class='comment val'># and we want to pass that back to sinatra since it isn't a MissingTemplate</span>
      <span class='comment val'># error</span>
      <span class='def def kw'>def</span> <span class='render_with_format identifier id'>render_with_format</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
        <span class='assumed_layout identifier id'>assumed_layout</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='symbol val'>:layout</span>
        <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{args[1]}.#{format}&quot;</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span> <span class='if if_mod kw'>if</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='colon3 op'>::</span><span class='Symbol constant id'>Symbol</span><span class='rparen token'>)</span>
        <span class='render_without_format identifier id'>render_without_format</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span>
      <span class='rescue rescue kw'>rescue</span> <span class='Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='ENOENT constant id'>ENOENT</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
        <span class='raise identifier id'>raise</span> <span class='MissingTemplate constant id'>MissingTemplate</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{args[1]}.#{args[0]}&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='assumed_layout identifier id'>assumed_layout</span>
        <span class='raise identifier id'>raise</span> <span class='e identifier id'>e</span>
      <span class='end end kw'>end</span>
      <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:render_without_format</span><span class='comma token'>,</span> <span class='symbol val'>:render</span>
      <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:render</span><span class='comma token'>,</span> <span class='symbol val'>:render_with_format</span>

      <span class='if if kw'>if</span> <span class='colon3 op'>::</span><span class='Sinatra constant id'>Sinatra</span><span class='colon2 op'>::</span><span class='VERSION constant id'>VERSION</span> <span class='match op'>=~</span> <span class='regexp val'>/^0\.9/</span>
        <span class='def def kw'>def</span> <span class='lookup_layout_with_format identifier id'>lookup_layout_with_format</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
          <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{args[1]}.#{format}&quot;</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span> <span class='if if_mod kw'>if</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='colon3 op'>::</span><span class='Symbol constant id'>Symbol</span><span class='rparen token'>)</span>
          <span class='lookup_layout_without_format identifier id'>lookup_layout_without_format</span> <span class='mult op'>*</span><span class='args identifier id'>args</span>
        <span class='end end kw'>end</span>
        <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:lookup_layout_without_format</span><span class='comma token'>,</span> <span class='symbol val'>:lookup_layout</span>
        <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:lookup_layout</span><span class='comma token'>,</span> <span class='symbol val'>:lookup_layout_with_format</span>
      <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="accept_to_array-instance_method">
  
    - (<tt>Object</tt>) <strong>accept_to_array</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
We need to pass array of available response types to best_media_type method
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


45
46
47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sinatra/respond_to.rb', line 45</span>

<span class='def def kw'>def</span> <span class='accept_to_array identifier id'>accept_to_array</span>
  <span class='SUPPORTED_ACCEPT_HEADERS constant id'>SUPPORTED_ACCEPT_HEADERS</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='bitor op'>|</span>
    <span class='SUPPORTED_ACCEPT_HEADERS constant id'>SUPPORTED_ACCEPT_HEADERS</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lookup_format_from_mime-instance_method">
  
    - (<tt>Object</tt>) <strong>lookup_format_from_mime</strong>(mime) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Then, when we get best media type for response, we need to know which
format to choose
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sinatra/respond_to.rb', line 53</span>

<span class='def def kw'>def</span> <span class='lookup_format_from_mime identifier id'>lookup_format_from_mime</span><span class='lparen token'>(</span><span class='mime identifier id'>mime</span><span class='rparen token'>)</span>
  <span class='SUPPORTED_ACCEPT_HEADERS constant id'>SUPPORTED_ACCEPT_HEADERS</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='format identifier id'>format</span><span class='bitor op'>|</span>
    <span class='return return kw'>return</span> <span class='format identifier id'>format</span> <span class='if if_mod kw'>if</span> <span class='SUPPORTED_ACCEPT_HEADERS constant id'>SUPPORTED_ACCEPT_HEADERS</span><span class='lbrack token'>[</span><span class='format identifier id'>format</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='mime identifier id'>mime</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Sep 30 14:43:55 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.8.6).
</div>

  </body>
</html>